<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vibe Code Community</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;1,9..40,300&display=swap" rel="stylesheet">

<!-- â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
     â•‘  FIREBASE CONFIG â€” á€’á€®á€”á€±á€›á€¬á€™á€¾á€¬ á€á€„á€·á€º config á€‘á€Šá€·á€ºá€•á€«  â•‘
     â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
  import { getFirestore, collection, addDoc, getDocs, doc, updateDoc, onSnapshot, query, orderBy, serverTimestamp, where }
    from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

  // â–¼â–¼â–¼ YOUR FIREBASE CONFIG HERE â–¼â–¼â–¼
  const firebaseConfig = {
    apiKey:            "YOUR_API_KEY",
    authDomain:        "YOUR_PROJECT.firebaseapp.com",
    projectId:         "YOUR_PROJECT_ID",
    storageBucket:     "YOUR_PROJECT.appspot.com",
    messagingSenderId: "YOUR_SENDER_ID",
    appId:             "YOUR_APP_ID"
  };
  // â–²â–²â–² END CONFIG â–²â–²â–²

  const app = initializeApp(firebaseConfig);
  const db  = getFirestore(app);
  window._db = db;
  window._fb = { collection, addDoc, getDocs, doc, updateDoc, onSnapshot, query, orderBy, serverTimestamp, where };
  window._firebaseReady = true;
  document.dispatchEvent(new Event('firebase-ready'));
</script>

<style>
/* â”€â”€ RESET & ROOT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
:root{
  --bg:#09090f;--bg2:#0e0e18;--surface:#13131f;--surface2:#1a1a2a;
  --border:rgba(255,255,255,.07);--border2:rgba(255,255,255,.12);
  --accent:#7c5cfc;--accent2:#a78bfa;--orange:#f97316;--green:#22d3a5;
  --red:#f43f5e;--yellow:#fbbf24;
  --text:#f1f0ff;--text2:#9896b8;--text3:#5e5c78;
  --font-head:'Syne',sans-serif;--font-body:'DM Sans',sans-serif;
  --r-sm:8px;--r-md:14px;--r-lg:20px;--r-xl:28px;
  --shadow:0 0 0 1px rgba(255,255,255,.06),0 24px 60px rgba(0,0,0,.5);
}
html,body{height:100%;font-family:var(--font-body);background:var(--bg);color:var(--text);overflow:hidden}
::-webkit-scrollbar{width:4px}::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:var(--surface2);border-radius:99px}
#app{width:100%;height:100vh;position:relative;overflow:hidden;
  background-image:radial-gradient(ellipse 80% 60% at 20% 10%,rgba(124,92,252,.15) 0%,transparent 60%),
  radial-gradient(ellipse 60% 50% at 80% 80%,rgba(249,115,22,.1) 0%,transparent 55%)}
.screen{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;
  opacity:0;pointer-events:none;transition:opacity .35s ease,transform .35s ease;transform:translateY(10px)}
.screen.active{opacity:1;pointer-events:all;transform:translateY(0)}
/* BUTTONS */
.btn{display:inline-flex;align-items:center;gap:8px;padding:12px 24px;border-radius:var(--r-md);
  border:none;font-family:var(--font-body);font-size:.95rem;font-weight:500;cursor:pointer;transition:all .2s}
.btn-primary{background:var(--accent);color:#fff}
.btn-primary:hover{background:#8b6dfd;transform:translateY(-2px);box-shadow:0 8px 32px rgba(124,92,252,.4)}
.btn-ghost{background:var(--surface);color:var(--text2);border:1px solid var(--border2)}
.btn-ghost:hover{background:var(--surface2);color:var(--text);transform:translateY(-1px)}
.btn-sm{padding:7px 14px;font-size:.82rem;border-radius:var(--r-sm)}
.btn-success{background:rgba(34,211,165,.12);color:var(--green);border:1px solid rgba(34,211,165,.3)}
.btn-success:hover{background:rgba(34,211,165,.22)}
.btn-danger{background:rgba(244,63,94,.12);color:var(--red);border:1px solid rgba(244,63,94,.3)}
.btn-danger:hover{background:rgba(244,63,94,.22)}
.card{background:var(--surface);border:1px solid var(--border);border-radius:var(--r-xl);box-shadow:var(--shadow)}
/* BADGE */
.badge{display:inline-flex;align-items:center;gap:5px;padding:4px 12px;border-radius:99px;font-size:.76rem;font-weight:600}
.badge-pending{background:rgba(251,191,36,.12);color:var(--yellow);border:1px solid rgba(251,191,36,.25)}
.badge-approved{background:rgba(34,211,165,.12);color:var(--green);border:1px solid rgba(34,211,165,.3)}
.badge-rejected{background:rgba(244,63,94,.12);color:var(--red);border:1px solid rgba(244,63,94,.3)}
/* CHIPS */
.chips-wrap{display:flex;flex-wrap:wrap;gap:7px;margin-top:4px}
.chip{padding:6px 13px;border-radius:99px;border:1px solid var(--border2);font-size:.8rem;
  cursor:pointer;transition:all .18s;color:var(--text2);background:var(--surface2);user-select:none}
.chip:hover{border-color:var(--accent);color:var(--accent2)}
.chip.selected{background:rgba(124,92,252,.18);border-color:var(--accent);color:var(--accent2);font-weight:500}
/* FIELDS */
.field{margin-bottom:20px}
.field label{display:block;font-size:.78rem;font-weight:700;letter-spacing:.06em;text-transform:uppercase;
  color:var(--text3);margin-bottom:7px}
.field input,.field textarea{width:100%;padding:11px 15px;background:var(--surface2);border:1px solid var(--border);
  border-radius:var(--r-md);color:var(--text);font-family:var(--font-body);font-size:.93rem;outline:none;
  transition:border-color .2s,box-shadow .2s}
.field input:focus,.field textarea:focus{border-color:var(--accent);box-shadow:0 0 0 3px rgba(124,92,252,.12)}
.field input::placeholder,.field textarea::placeholder{color:var(--text3)}
.field textarea{resize:vertical;min-height:88px;line-height:1.6}
.field-row{display:grid;grid-template-columns:1fr 1fr;gap:14px}
.field-error{font-size:.76rem;color:var(--red);margin-top:4px;display:none}
.field.has-error input,.field.has-error textarea{border-color:var(--red)}
.field.has-error .field-error{display:block}
/* ANIMS */
@keyframes logoFloat{0%,100%{transform:translateY(0)}50%{transform:translateY(-6px)}}
@keyframes ping{from{opacity:.4}to{opacity:1}}
@keyframes spin{to{transform:rotate(360deg)}}
@keyframes pendingPulse{0%,100%{box-shadow:0 0 0 0 rgba(251,191,36,.25)}50%{box-shadow:0 0 0 14px rgba(251,191,36,0)}}
.live-dot{width:7px;height:7px;background:var(--green);border-radius:50%;animation:ping .8s ease-in-out infinite alternate;flex-shrink:0}
.loader{width:18px;height:18px;border:2px solid rgba(255,255,255,.15);border-top-color:var(--accent);
  border-radius:50%;animation:spin .6s linear infinite}

/* â•â• LANDING â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#s-landing{overflow-y:auto;align-items:flex-start}
.landing-inner{max-width:860px;width:100%;margin:auto;padding:64px 24px;display:flex;flex-direction:column;align-items:center;text-align:center}
.logo-mark{width:66px;height:66px;border-radius:18px;background:linear-gradient(135deg,#7c5cfc,#f97316);
  display:grid;place-items:center;font-size:28px;margin-bottom:26px;
  box-shadow:0 0 0 8px rgba(124,92,252,.12),0 20px 60px rgba(124,92,252,.3);
  animation:logoFloat 3s ease-in-out infinite}
.hero-tag{display:inline-flex;align-items:center;gap:6px;padding:5px 14px;
  background:rgba(124,92,252,.1);border:1px solid rgba(124,92,252,.28);
  border-radius:99px;font-size:.75rem;font-weight:700;color:var(--accent2);
  letter-spacing:.07em;text-transform:uppercase;margin-bottom:18px}
h1.hero-title{font-family:var(--font-head);font-size:clamp(2.2rem,5.5vw,4rem);
  font-weight:800;line-height:1.1;letter-spacing:-.03em;margin-bottom:16px}
h1.hero-title .grad{background:linear-gradient(100deg,#a78bfa 10%,#f97316 55%,#fbbf24 100%);
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.hero-sub{font-size:1.02rem;color:var(--text2);max-width:480px;line-height:1.75;margin-bottom:36px}
.hero-ctas{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin-bottom:52px}
.hero-stats{display:flex;gap:2px;border:1px solid var(--border);border-radius:var(--r-lg);overflow:hidden}
.stat-item{padding:18px 30px;display:flex;flex-direction:column;gap:3px;border-right:1px solid var(--border)}
.stat-item:last-child{border-right:none}
.stat-num{font-family:var(--font-head);font-size:1.6rem;font-weight:800}
.stat-label{font-size:.72rem;color:var(--text3);text-transform:uppercase;letter-spacing:.08em}

/* â•â• REGISTER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#s-register{overflow-y:auto;align-items:flex-start;padding:36px 20px}
.form-wrap{max-width:570px;width:100%;margin:auto;padding:16px 0}
.form-back{display:inline-flex;align-items:center;gap:6px;color:var(--text3);font-size:.86rem;
  cursor:pointer;margin-bottom:24px;transition:color .2s}
.form-back:hover{color:var(--text)}
.form-header{margin-bottom:28px}
.form-header h2{font-family:var(--font-head);font-size:1.75rem;font-weight:800;letter-spacing:-.02em;margin-bottom:5px}
.form-header p{color:var(--text2);font-size:.9rem}
.form-card{padding:32px}
.form-submit{width:100%;padding:13px;border-radius:var(--r-md);background:var(--accent);color:#fff;
  font-family:var(--font-body);font-size:.97rem;font-weight:600;border:none;cursor:pointer;
  transition:all .2s;margin-top:6px;display:flex;align-items:center;justify-content:center;gap:8px}
.form-submit:hover{background:#8b6dfd;transform:translateY(-1px);box-shadow:0 8px 24px rgba(124,92,252,.35)}
.form-submit:disabled{opacity:.5;cursor:not-allowed;transform:none}

/* â•â• PENDING â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#s-pending{overflow-y:auto;padding:40px 20px}
.pending-wrap{max-width:460px;width:100%;margin:auto;text-align:center;padding:20px 0}
.pending-icon{width:78px;height:78px;margin:0 auto 26px;background:rgba(251,191,36,.1);
  border:1px solid rgba(251,191,36,.25);border-radius:50%;display:grid;place-items:center;font-size:2rem;
  animation:pendingPulse 2.5s ease-in-out infinite}
.pending-wrap h2{font-family:var(--font-head);font-size:1.75rem;font-weight:800;margin-bottom:8px}
.pending-wrap p{color:var(--text2);line-height:1.7;margin-bottom:26px}
.status-card{padding:22px;margin-bottom:18px}
.status-row{display:flex;justify-content:space-between;align-items:center;padding:9px 0;
  border-bottom:1px solid var(--border);font-size:.88rem}
.status-row:last-child{border-bottom:none}
.status-key{color:var(--text3)}
.status-val{font-weight:500}

/* â•â• ADMIN â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#s-admin{align-items:stretch}
.admin-layout{width:100%;height:100%;display:flex;flex-direction:column}
.admin-topbar{display:flex;align-items:center;justify-content:space-between;padding:0 22px;
  height:56px;border-bottom:1px solid var(--border);background:var(--surface);flex-shrink:0}
.admin-brand{display:flex;align-items:center;gap:10px}
.admin-red-dot{width:8px;height:8px;background:var(--red);border-radius:50%;animation:ping .6s ease-in-out infinite alternate}
.admin-title{font-family:var(--font-head);font-weight:700;font-size:.97rem}
.admin-body{flex:1;overflow-y:auto;padding:24px}
.stats-row{display:flex;gap:10px;margin-bottom:24px;flex-wrap:wrap}
.stat-card{flex:1;min-width:90px;padding:14px 18px;background:var(--surface);
  border:1px solid var(--border);border-radius:var(--r-md)}
.stat-card .num{font-family:var(--font-head);font-size:1.75rem;font-weight:800}
.stat-card .lbl{font-size:.72rem;color:var(--text3);text-transform:uppercase;letter-spacing:.06em;margin-top:2px}
.stat-card.c-orange .num{color:var(--orange)}
.stat-card.c-green .num{color:var(--green)}
.stat-card.c-red .num{color:var(--red)}
.tabs-row{display:flex;gap:2px;background:var(--surface);border:1px solid var(--border);
  border-radius:var(--r-md);padding:4px;margin-bottom:18px;width:fit-content}
.tab-btn{padding:7px 18px;border-radius:10px;border:none;font-family:var(--font-body);font-size:.83rem;
  font-weight:500;cursor:pointer;background:transparent;color:var(--text3);transition:all .2s}
.tab-btn.active{background:var(--surface2);color:var(--text)}
.applicant-list{display:flex;flex-direction:column;gap:11px}
.applicant-card{background:var(--surface);border:1px solid var(--border);border-radius:var(--r-lg);
  padding:18px 20px;display:flex;gap:14px;align-items:flex-start;transition:border-color .2s}
.applicant-card:hover{border-color:var(--border2)}
.app-avatar{width:42px;height:42px;border-radius:11px;flex-shrink:0;display:grid;place-items:center;
  font-family:var(--font-head);font-size:.95rem;font-weight:800;color:#fff}
.app-info{flex:1;min-width:0}
.app-name{font-weight:700;font-size:.93rem;margin-bottom:2px}
.app-meta{font-size:.78rem;color:var(--text3);margin-bottom:8px}
.app-tags{display:flex;flex-wrap:wrap;gap:5px;margin-bottom:9px}
.app-tag{padding:2px 9px;background:var(--surface2);border:1px solid var(--border);border-radius:99px;font-size:.72rem;color:var(--text2)}
.app-vision{font-size:.8rem;color:var(--text2);line-height:1.5;padding:9px 11px;background:var(--surface2);border-radius:var(--r-sm)}
.app-actions{display:flex;flex-direction:column;gap:7px;align-items:flex-end;flex-shrink:0}
.empty-state{text-align:center;padding:44px 20px;color:var(--text3)}
.empty-state .ico{font-size:2.4rem;margin-bottom:10px}
.empty-state p{font-size:.88rem}

/* â•â• COMMUNITY â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#s-community{align-items:stretch}
.comm-layout{width:100%;height:100%;display:flex;flex-direction:column}
.comm-topbar{display:flex;align-items:center;padding:0 18px;height:56px;
  border-bottom:1px solid var(--border);background:var(--surface);flex-shrink:0;gap:14px;justify-content:space-between}
.comm-brand{display:flex;align-items:center;gap:8px;font-family:var(--font-head);font-weight:800;font-size:.95rem}
.comm-channels{display:flex;gap:3px}
.channel-btn{padding:5px 12px;border-radius:var(--r-sm);border:none;font-family:var(--font-body);font-size:.8rem;
  font-weight:500;cursor:pointer;background:transparent;color:var(--text3);transition:all .2s}
.channel-btn.active{background:var(--surface2);color:var(--text)}
.comm-main{flex:1;display:flex;overflow:hidden}
.comm-sidebar{width:230px;flex-shrink:0;border-right:1px solid var(--border);
  display:flex;flex-direction:column;overflow:hidden;background:var(--surface)}
.sidebar-me{padding:12px 14px;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:9px}
.sidebar-me-info .name{font-size:.86rem;font-weight:600}
.sidebar-me-info .role{font-size:.72rem;color:var(--text3)}
.sidebar-section{padding:11px 14px 5px;font-size:.68rem;font-weight:700;letter-spacing:.1em;
  text-transform:uppercase;color:var(--text3)}
.sidebar-members{flex:1;overflow-y:auto;padding-bottom:10px}
.sidebar-member{display:flex;align-items:center;gap:8px;padding:7px 14px;cursor:pointer;transition:background .15s}
.sidebar-member:hover{background:var(--surface2)}
.sidebar-member .m-name{font-size:.83rem;font-weight:500}
.sidebar-member .m-job{font-size:.7rem;color:var(--text3)}
.sm-avatar{width:28px;height:28px;border-radius:7px;flex-shrink:0;display:grid;place-items:center;
  font-size:.7rem;font-weight:800;color:#fff;position:relative}
.sm-avatar .dot{position:absolute;bottom:-1px;right:-1px;width:7px;height:7px;background:var(--green);
  border:2px solid var(--surface);border-radius:50%}
.chat-area{flex:1;display:flex;flex-direction:column;overflow:hidden}
.chat-header{padding:13px 18px;border-bottom:1px solid var(--border);display:flex;align-items:center;
  justify-content:space-between;background:var(--surface);flex-shrink:0}
.channel-name{font-family:var(--font-head);font-size:.97rem;font-weight:700}
.channel-desc{font-size:.76rem;color:var(--text3);margin-top:1px}
.chat-msgs{flex:1;overflow-y:auto;padding:18px;display:flex;flex-direction:column;gap:14px}
.msg-group{display:flex;gap:11px}
.msg-avatar{width:34px;height:34px;border-radius:9px;flex-shrink:0;display:grid;place-items:center;
  font-size:.8rem;font-weight:800;color:#fff;margin-top:2px}
.msg-body{flex:1}
.msg-header{display:flex;align-items:baseline;gap:7px;margin-bottom:3px;flex-wrap:wrap}
.msg-name{font-size:.86rem;font-weight:700}
.msg-goal{font-size:.7rem;color:var(--text3);font-style:italic}
.msg-time{font-size:.68rem;color:var(--text3);margin-left:auto}
.msg-text{font-size:.89rem;color:#d4d2f0;line-height:1.6;max-width:580px;word-break:break-word}
.msg-own .msg-group{flex-direction:row-reverse}
.msg-own .msg-body{text-align:right}
.msg-own .msg-header{flex-direction:row-reverse}
.msg-own .msg-goal{display:none}
.msg-own .msg-text{color:#e0ddff;background:rgba(124,92,252,.15);padding:9px 13px;border-radius:12px 12px 2px 12px;display:inline-block;text-align:left}
.chat-input-row{padding:13px 18px;border-top:1px solid var(--border);background:var(--surface);flex-shrink:0}
.chat-input-box{display:flex;align-items:center;gap:9px;background:var(--surface2);
  border:1px solid var(--border);border-radius:var(--r-md);padding:9px 14px;transition:border-color .2s}
.chat-input-box:focus-within{border-color:var(--accent)}
.chat-input-box input{flex:1;background:transparent;border:none;outline:none;
  font-family:var(--font-body);font-size:.9rem;color:var(--text)}
.chat-input-box input::placeholder{color:var(--text3)}
.send-btn{width:32px;height:32px;border-radius:var(--r-sm);background:var(--accent);border:none;
  color:#fff;cursor:pointer;display:grid;place-items:center;transition:all .2s;flex-shrink:0;font-size:.9rem}
.send-btn:hover{background:#8b6dfd;transform:scale(1.06)}
.members-panel{flex:1;overflow-y:auto;padding:18px;display:grid;
  grid-template-columns:repeat(auto-fill,minmax(270px,1fr));gap:12px;align-content:start}
.member-card{background:var(--surface);border:1px solid var(--border);border-radius:var(--r-lg);padding:18px;
  transition:border-color .2s}
.member-card:hover{border-color:var(--border2)}
.member-card-top{display:flex;align-items:center;gap:11px;margin-bottom:12px}
.member-card-avatar{width:44px;height:44px;border-radius:11px;display:grid;place-items:center;
  font-family:var(--font-head);font-size:1.05rem;font-weight:800;color:#fff;flex-shrink:0}
.member-card-name{font-weight:700;font-size:.92rem}
.member-card-job{font-size:.75rem;color:var(--text3);margin-top:1px}
.member-card-chips{display:flex;flex-wrap:wrap;gap:5px;margin-bottom:10px}
.member-chip{padding:2px 9px;background:rgba(124,92,252,.1);border:1px solid rgba(124,92,252,.2);
  border-radius:99px;font-size:.7rem;color:var(--accent2)}
.member-goal{font-size:.8rem;color:var(--text2);line-height:1.5;padding:9px 11px;background:var(--surface2);border-radius:var(--r-sm)}
.member-goal span{color:var(--orange);font-size:.7rem;font-weight:700;display:block;margin-bottom:2px;text-transform:uppercase;letter-spacing:.05em}

/* â•â• TOAST â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#toast-wrap{position:fixed;bottom:22px;right:22px;display:flex;flex-direction:column;gap:7px;z-index:999;pointer-events:none}
.toast{padding:11px 16px;background:var(--surface2);border:1px solid var(--border2);border-radius:var(--r-md);
  font-size:.86rem;color:var(--text);box-shadow:0 8px 30px rgba(0,0,0,.4);
  opacity:0;transform:translateX(18px);transition:all .3s ease;pointer-events:none;display:flex;align-items:center;gap:7px}
.toast.show{opacity:1;transform:translateX(0)}
.toast.t-success{border-color:rgba(34,211,165,.3)}
.toast.t-error{border-color:rgba(244,63,94,.3)}

@media(max-width:640px){
  .comm-sidebar{display:none}
  .field-row{grid-template-columns:1fr}
  .hero-stats{flex-direction:column;border-radius:var(--r-md)}
  .stat-item{border-right:none;border-bottom:1px solid var(--border)}
  .stat-item:last-child{border-bottom:none}
  .comm-channels{display:none}
}
</style>

</head>
<body>
<div id="app">

<!-- â•â• LANDING â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<div class="screen active" id="s-landing">
  <div class="landing-inner">
    <div class="logo-mark">âš¡</div>
    <div class="hero-tag"><div class="live-dot"></div> Accepting Applications</div>
    <h1 class="hero-title">Where Builders<br><span class="grad">Vibe &amp; Connect</span></h1>
    <p class="hero-sub">A curated community for young entrepreneurs & business enthusiasts. Apply, get approved, and network with driven people building the future.</p>
    <div class="hero-ctas">
      <button class="btn btn-primary" onclick="goTo('s-register')">âœ¦ Apply to Join â†’</button>
      <button class="btn btn-ghost" onclick="promptAdmin()">ğŸ” Admin Panel</button>
    </div>
    <div class="hero-stats">
      <div class="stat-item"><div class="stat-num" id="hs-members">â€”</div><div class="stat-label">Members</div></div>
      <div class="stat-item"><div class="stat-num" id="hs-pending">â€”</div><div class="stat-label">Pending</div></div>
      <div class="stat-item"><div class="stat-num" id="hs-msgs">â€”</div><div class="stat-label">Messages</div></div>
    </div>
  </div>
</div>

<!-- â•â• REGISTER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<div class="screen" id="s-register">
  <div class="form-wrap">
    <div class="form-back" onclick="goTo('s-landing')">â† Back</div>
    <div class="form-header">
      <h2>Join Vibe Code</h2>
      <p>Applications are reviewed within 24 hours.</p>
    </div>
    <div class="card form-card" id="form-card">
      <div class="field-row">
        <div class="field" id="f-name">
          <label>Full Name</label>
          <input type="text" id="i-name" placeholder="Ko Aung Zaw Oo">
          <div class="field-error">Name is required</div>
        </div>
        <div class="field" id="f-age">
          <label>Age</label>
          <input type="number" id="i-age" placeholder="24" min="15" max="45">
          <div class="field-error">Age must be 15â€“45</div>
        </div>
      </div>
      <div class="field" id="f-job">
        <label>Current Occupation</label>
        <input type="text" id="i-job" placeholder="Startup Founder, Freelancer, etc.">
        <div class="field-error">Occupation is required</div>
      </div>
      <div class="field" id="f-hobbies">
        <label>Focus Areas <span style="color:var(--text3);font-weight:400;text-transform:none;letter-spacing:0">(select â‰¥1)</span></label>
        <div class="chips-wrap" id="chips-wrap"></div>
        <div class="field-error">Select at least one</div>
      </div>
      <div class="field" id="f-vision">
        <label>Future Aspirations</label>
        <textarea id="i-vision" placeholder="Where do you see yourself in 3â€“5 years?"></textarea>
        <div class="field-error">Please share your vision</div>
      </div>
      <button class="form-submit" id="form-btn" onclick="submitForm()">Submit Application â†’</button>
    </div>
    <div class="card" id="form-success" style="display:none;padding:38px;text-align:center">
      <div style="font-size:2.4rem;margin-bottom:14px">ğŸ‰</div>
      <h3 style="font-family:var(--font-head);font-size:1.35rem;font-weight:800;margin-bottom:9px">Application Submitted!</h3>
      <p style="color:var(--text2);line-height:1.75;margin-bottom:22px">
        Your profile is being reviewed.<br>You'll gain access once <strong style="color:var(--accent2)">approved by the admin.</strong>
      </p>
      <button class="btn btn-ghost" onclick="goToPending()" style="width:100%">Check Application Status â†’</button>
    </div>
  </div>
</div>

<!-- â•â• PENDING â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<div class="screen" id="s-pending">
  <div class="pending-wrap">
    <div class="pending-icon">â³</div>
    <h2>Under Review</h2>
    <p>Your application is in the queue. Admin reviews within 24 hours.</p>
    <div class="card status-card" id="pending-card"></div>
    <button class="btn btn-ghost" onclick="goTo('s-landing')" style="width:100%">â† Back to Home</button>
  </div>
</div>

<!-- â•â• ADMIN â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<div class="screen" id="s-admin">
  <div class="admin-layout">
    <div class="admin-topbar">
      <div class="admin-brand">
        <div class="admin-red-dot"></div>
        <div class="admin-title">Admin Dashboard â€” Vibe Code</div>
      </div>
      <div style="display:flex;gap:8px;align-items:center">
        <div id="admin-loading" class="loader" style="display:none"></div>
        <button class="btn btn-ghost btn-sm" onclick="goTo('s-landing')">Exit</button>
      </div>
    </div>
    <div class="admin-body">
      <div class="stats-row">
        <div class="stat-card c-orange"><div class="num" id="a-pending">â€”</div><div class="lbl">Pending</div></div>
        <div class="stat-card c-green"><div class="num" id="a-approved">â€”</div><div class="lbl">Approved</div></div>
        <div class="stat-card c-red"><div class="num" id="a-rejected">â€”</div><div class="lbl">Rejected</div></div>
        <div class="stat-card"><div class="num" id="a-total">â€”</div><div class="lbl">Total</div></div>
      </div>
      <div class="tabs-row">
        <button class="tab-btn active" id="tab-pending" onclick="switchAdminTab('pending')">â³ Pending</button>
        <button class="tab-btn" id="tab-approved" onclick="switchAdminTab('approved')">âœ… Approved</button>
        <button class="tab-btn" id="tab-rejected" onclick="switchAdminTab('rejected')">âŒ Rejected</button>
      </div>
      <div class="applicant-list" id="admin-list"><div class="empty-state"><div class="ico loader" style="margin:0 auto 10px"></div><p>Loadingâ€¦</p></div></div>
    </div>
  </div>
</div>

<!-- â•â• COMMUNITY â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<div class="screen" id="s-community">
  <div class="comm-layout">
    <div class="comm-topbar">
      <div class="comm-brand"><div class="live-dot"></div>Vibe Code</div>
      <div class="comm-channels" id="comm-channels">
        <button class="channel-btn active" onclick="setChannel('general','# general','Real-time networking & discussion')" data-ch="general"># general</button>
        <button class="channel-btn" onclick="setChannel('invest','ğŸ“ˆ invest','Investment ideas & finance')" data-ch="invest">ğŸ“ˆ invest</button>
        <button class="channel-btn" onclick="setChannel('collab','ğŸ¤ collab','Find co-founders & partners')" data-ch="collab">ğŸ¤ collab</button>
        <button class="channel-btn" onclick="setChannel('wins','ğŸ† wins','Share your victories')" data-ch="wins">ğŸ† wins</button>
      </div>
      <div style="display:flex;gap:7px;align-items:center">
        <button class="channel-btn" id="view-members-btn" onclick="toggleMembersView()">ğŸ‘¥ Members</button>
        <button class="btn btn-ghost btn-sm" onclick="goTo('s-landing')">Exit</button>
      </div>
    </div>
    <div class="comm-main">
      <div class="comm-sidebar">
        <div class="sidebar-me" id="sidebar-me"></div>
        <div class="sidebar-section">Online Members</div>
        <div class="sidebar-members" id="sidebar-members"></div>
      </div>
      <!-- Chat -->
      <div class="chat-area" id="chat-view">
        <div class="chat-header">
          <div>
            <div class="channel-name" id="ch-name"># general</div>
            <div class="channel-desc" id="ch-desc">Real-time networking & discussion</div>
          </div>
          <span style="font-size:.76rem;color:var(--text3)" id="ch-count"></span>
        </div>
        <div class="chat-msgs" id="chat-msgs"><div class="empty-state"><div class="ico loader" style="margin:0 auto 10px"></div><p>Loading messagesâ€¦</p></div></div>
        <div class="chat-input-row">
          <div class="chat-input-box">
            <input id="chat-input" placeholder="Message # generalâ€¦" onkeydown="if(event.key==='Enter')sendMessage()">
            <button class="send-btn" onclick="sendMessage()">â¤</button>
          </div>
        </div>
      </div>
      <!-- Members -->
      <div class="chat-area" id="members-view" style="display:none">
        <div class="chat-header">
          <div class="channel-name">ğŸ‘¥ Community Members</div>
          <span style="font-size:.76rem;color:var(--text3)" id="members-view-count"></span>
        </div>
        <div class="members-panel" id="members-panel"></div>
      </div>
    </div>
  </div>
</div>

</div><!-- #app -->
<div id="toast-wrap"></div>

<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CONSTANTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const ADMIN_PASS = 'admin123'; // â† á€á€„á€·á€º password á€•á€¼á€±á€¬á€„á€ºá€¸á€•á€«
const HOBBYLIST = [
  'E-Commerce','Tech & AI','Digital Marketing','Finance','Real Estate',
  'Content Creation','Import/Export','F&B','SaaS','Education',
  'Healthcare','Design','Crypto/Web3','Consulting','Manufacturing'
];
const AVATAR_COLORS = [
  '#7c5cfc','#f97316','#22d3a5','#f43f5e','#fbbf24',
  '#3b82f6','#ec4899','#10b981','#8b5cf6','#06b6d4'
];

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   STATE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let db, FB;
let currentUser = null;
let currentScreen = 's-landing';
let adminTab = 'pending';
let currentChannel = 'general';
let showMembers = false;
let pendingDocId = null;
let msgUnsubscribe = null;
let allUsers = [];

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FIREBASE INIT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
document.addEventListener('firebase-ready', async () => {
  db = window._db;
  FB = window._fb;
  await loadStats();
});

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   UTILITIES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const initials = n => n.split(' ').map(w=>w[0]).join('').substring(0,2).toUpperCase();
const randColor = () => AVATAR_COLORS[Math.floor(Math.random()*AVATAR_COLORS.length)];
const escHtml = s => s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/\n/g,'<br>');
const fmtTime = ts => {
  if (!ts) return '';
  const d = ts.toDate ? ts.toDate() : new Date(ts);
  return d.toLocaleTimeString('en-US',{hour:'2-digit',minute:'2-digit'});
};

function toast(msg, type='info', dur=3200) {
  const wrap = document.getElementById('toast-wrap');
  const el = document.createElement('div');
  el.className = `toast t-${type}`;
  el.innerHTML = `<span>${type==='success'?'âœ“':type==='error'?'âœ—':'â„¹'}</span> ${msg}`;
  wrap.appendChild(el);
  requestAnimationFrame(()=>requestAnimationFrame(()=>el.classList.add('show')));
  setTimeout(()=>{el.classList.remove('show');setTimeout(()=>el.remove(),400);},dur);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   NAVIGATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function goTo(id) {
  document.getElementById(currentScreen).classList.remove('active');
  document.getElementById(id).classList.add('active');
  currentScreen = id;
  if (id === 's-landing') loadStats();
  if (id === 's-admin') loadAdmin();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LANDING STATS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function loadStats() {
  if (!db) return;
  try {
    const snap = await FB.getDocs(FB.collection(db,'users'));
    let members=0, pending=0;
    snap.forEach(d => { const s=d.data().status; if(s==='approved')members++; if(s==='pending')pending++; });
    const msgSnap = await FB.getDocs(FB.collection(db,'messages'));
    document.getElementById('hs-members').textContent = members;
    document.getElementById('hs-pending').textContent = pending;
    document.getElementById('hs-msgs').textContent = msgSnap.size;
  } catch(e) { console.warn('Stats error',e); }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CHIPS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let selectedHobbies = [];
function renderChips() {
  document.getElementById('chips-wrap').innerHTML = HOBBYLIST.map(h=>
    `<div class="chip ${selectedHobbies.includes(h)?'selected':''}" onclick="toggleChip('${h}')">${h}</div>`
  ).join('');
}
function toggleChip(h) {
  selectedHobbies = selectedHobbies.includes(h) ? selectedHobbies.filter(x=>x!==h) : [...selectedHobbies,h];
  renderChips();
  document.getElementById('f-hobbies').classList.remove('has-error');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   REGISTER â†’ FIRESTORE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function submitForm() {
  const name   = document.getElementById('i-name').value.trim();
  const age    = parseInt(document.getElementById('i-age').value);
  const job    = document.getElementById('i-job').value.trim();
  const vision = document.getElementById('i-vision').value.trim();
  let valid = true;
  const err = (id, bad) => { document.getElementById(id).classList.toggle('has-error',bad); if(bad)valid=false; };
  err('f-name', !name);
  err('f-age', !age||age<15||age>45);
  err('f-job', !job);
  err('f-hobbies', selectedHobbies.length===0);
  err('f-vision', !vision);
  if (!valid) { toast('Please fill in all fields','error'); return; }

  const btn = document.getElementById('form-btn');
  btn.disabled = true;
  btn.innerHTML = '<div class="loader"></div> Submittingâ€¦';

  try {
    const docRef = await FB.addDoc(FB.collection(db,'users'), {
      name, age, job, vision,
      hobbies: selectedHobbies,
      color: randColor(),
      status: 'pending',
      createdAt: FB.serverTimestamp()
    });
    pendingDocId = docRef.id;
    document.getElementById('form-card').style.display = 'none';
    document.getElementById('form-success').style.display = 'block';
    toast('Application submitted! ğŸ‰','success');
    loadStats();
  } catch(e) {
    toast('Error submitting. Check Firebase config.','error');
    console.error(e);
  }
  btn.disabled = false;
  btn.textContent = 'Submit Application â†’';
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PENDING CHECK
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function goToPending() {
  if (!pendingDocId) { goTo('s-landing'); return; }
  try {
    const snap = await FB.getDocs(FB.query(FB.collection(db,'users')));
    let user;
    snap.forEach(d => { if(d.id===pendingDocId) user = {id:d.id,...d.data()}; });
    if (!user) { goTo('s-landing'); return; }
    renderPending(user);
    goTo('s-pending');
  } catch(e) { toast('Error fetching status','error'); }
}

function renderPending(user) {
  document.getElementById('pending-card').innerHTML = `
    <div class="status-row"><span class="status-key">Name</span><span class="status-val">${user.name}</span></div>
    <div class="status-row"><span class="status-key">Age</span><span class="status-val">${user.age} years old</span></div>
    <div class="status-row"><span class="status-key">Occupation</span><span class="status-val">${user.job}</span></div>
    <div class="status-row"><span class="status-key">Interests</span><span class="status-val">${user.hobbies.join(', ')}</span></div>
    <div class="status-row"><span class="status-key">Status</span>
      <span class="badge badge-${user.status}">${user.status==='pending'?'â³ Pending':user.status==='approved'?'âœ… Approved':'âŒ Rejected'}</span>
    </div>
    ${user.status==='approved'?`<div style="margin-top:12px"><button class="btn btn-primary" style="width:100%" onclick="enterCommunity(${JSON.stringify(user).replace(/"/g,'&quot;')})">Enter Community â†’</button></div>`:''}
  `;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ADMIN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function promptAdmin() {
  const pw = prompt('Admin Password:');
  if (pw === null) return;
  if (pw === ADMIN_PASS) { goTo('s-admin'); }
  else toast('Incorrect password','error');
}

async function loadAdmin() {
  document.getElementById('admin-loading').style.display = 'block';
  try {
    const snap = await FB.getDocs(FB.query(FB.collection(db,'users'), FB.orderBy('createdAt','desc')));
    allUsers = [];
    snap.forEach(d => allUsers.push({id:d.id,...d.data()}));
    renderAdminStats();
    renderAdminList();
  } catch(e) { toast('Failed to load users','error'); console.error(e); }
  document.getElementById('admin-loading').style.display = 'none';
}

function renderAdminStats() {
  const p = allUsers.filter(u=>u.status==='pending').length;
  const a = allUsers.filter(u=>u.status==='approved').length;
  const r = allUsers.filter(u=>u.status==='rejected').length;
  document.getElementById('a-pending').textContent = p;
  document.getElementById('a-approved').textContent = a;
  document.getElementById('a-rejected').textContent = r;
  document.getElementById('a-total').textContent = allUsers.length;
}

function switchAdminTab(tab) {
  adminTab = tab;
  ['pending','approved','rejected'].forEach(t =>
    document.getElementById('tab-'+t).classList.toggle('active',t===tab)
  );
  renderAdminList();
}

function renderAdminList() {
  const list = allUsers.filter(u=>u.status===adminTab);
  const el = document.getElementById('admin-list');
  if (!list.length) {
    el.innerHTML = `<div class="empty-state"><div class="ico">ğŸ“­</div><p>No ${adminTab} applications</p></div>`;
    return;
  }
  el.innerHTML = list.map(u => `
    <div class="applicant-card">
      <div class="app-avatar" style="background:${u.color||'#7c5cfc'}">${initials(u.name)}</div>
      <div class="app-info">
        <div class="app-name">${u.name}</div>
        <div class="app-meta">Age ${u.age} Â· ${u.job}</div>
        <div class="app-tags">${(u.hobbies||[]).map(h=>`<span class="app-tag">${h}</span>`).join('')}</div>
        <div class="app-vision">ğŸ¯ "${u.vision}"</div>
      </div>
      <div class="app-actions">
        <span class="badge badge-${u.status}">${u.status}</span>
        ${u.status!=='approved'?`<button class="btn btn-success btn-sm" onclick="updateStatus('${u.id}','approved','${u.name}')">âœ… Approve</button>`:''}
        ${u.status!=='rejected'?`<button class="btn btn-danger btn-sm" onclick="updateStatus('${u.id}','rejected','${u.name}')">âŒ Reject</button>`:''}
      </div>
    </div>
  `).join('');
}

async function updateStatus(userId, status, name) {
  try {
    await FB.updateDoc(FB.doc(db,'users',userId), { status });
    const u = allUsers.find(x=>x.id===userId);
    if (u) u.status = status;
    renderAdminStats();
    renderAdminList();
    loadStats();
    toast(`${name} ${status==='approved'?'approved âœ…':'rejected âŒ'}`, status==='approved'?'success':'error');
  } catch(e) { toast('Update failed','error'); console.error(e); }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   COMMUNITY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function enterCommunity(user) {
  currentUser = typeof user === 'string' ? JSON.parse(user) : user;
  renderCommunity();
  goTo('s-community');
}

async function renderCommunity() {
  // Fetch approved members
  const snap = await FB.getDocs(FB.query(FB.collection(db,'users'),FB.where('status','==','approved')));
  const members = [];
  snap.forEach(d => members.push({id:d.id,...d.data()}));

  document.getElementById('ch-count').textContent = `${members.length} members`;
  document.getElementById('members-view-count').textContent = `${members.length} members`;

  // My profile in sidebar
  document.getElementById('sidebar-me').innerHTML = `
    <div class="sm-avatar" style="background:${currentUser.color}">${initials(currentUser.name)}<div class="dot"></div></div>
    <div class="sidebar-me-info"><div class="name">${currentUser.name}</div><div class="role">${(currentUser.hobbies||[])[0]||'Member'}</div></div>
  `;

  // Sidebar members list
  document.getElementById('sidebar-members').innerHTML = members.map(m=>`
    <div class="sidebar-member">
      <div class="sm-avatar" style="background:${m.color}">${initials(m.name)}<div class="dot"></div></div>
      <div><div class="m-name">${m.name}</div><div class="m-job">${m.job}</div></div>
    </div>
  `).join('');

  // Members panel
  document.getElementById('members-panel').innerHTML = members.map(m=>`
    <div class="member-card">
      <div class="member-card-top">
        <div class="member-card-avatar" style="background:${m.color}">${initials(m.name)}</div>
        <div><div class="member-card-name">${m.name}</div><div class="member-card-job">${m.age}y Â· ${m.job}</div></div>
      </div>
      <div class="member-card-chips">${(m.hobbies||[]).map(h=>`<span class="member-chip">${h}</span>`).join('')}</div>
      <div class="member-goal"><span>Future Goal</span>${m.vision}</div>
    </div>
  `).join('');

  subscribeMessages();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   REAL-TIME MESSAGES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function subscribeMessages() {
  if (msgUnsubscribe) msgUnsubscribe();
  const q = FB.query(
    FB.collection(db,'messages'),
    FB.where('channel','==',currentChannel),
    FB.orderBy('createdAt','asc')
  );
  msgUnsubscribe = FB.onSnapshot(q, snap => {
    const msgs = [];
    snap.forEach(d => msgs.push({id:d.id,...d.data()}));
    renderMessages(msgs);
  });
}

function renderMessages(msgs) {
  const el = document.getElementById('chat-msgs');
  if (!msgs.length) {
    el.innerHTML = `<div class="empty-state"><div class="ico">ğŸ’¬</div><p>Be the first to send a message!</p></div>`;
    return;
  }
  el.innerHTML = msgs.map(m => {
    const isMe = m.userId === currentUser.id;
    return `<div class="${isMe?'msg-own':''}">
      <div class="msg-group">
        <div class="msg-avatar" style="background:${m.color}">${initials(m.name)}</div>
        <div class="msg-body">
          <div class="msg-header">
            <span class="msg-name" style="color:${m.color}">${m.name}</span>
            ${!isMe&&m.goal?`<span class="msg-goal">Â· ${m.goal.substring(0,50)}â€¦</span>`:''}
            <span class="msg-time">${fmtTime(m.createdAt)}</span>
          </div>
          <div class="msg-text">${escHtml(m.text)}</div>
        </div>
      </div>
    </div>`;
  }).join('');
  el.scrollTop = el.scrollHeight;
}

async function sendMessage() {
  const input = document.getElementById('chat-input');
  const text = input.value.trim();
  if (!text || !currentUser) return;
  input.value = '';
  try {
    await FB.addDoc(FB.collection(db,'messages'), {
      userId: currentUser.id,
      name: currentUser.name,
      goal: currentUser.vision||'',
      color: currentUser.color,
      text,
      channel: currentChannel,
      createdAt: FB.serverTimestamp()
    });
  } catch(e) { toast('Send failed','error'); input.value = text; }
}

function setChannel(ch, name, desc) {
  currentChannel = ch;
  document.getElementById('ch-name').textContent = name;
  document.getElementById('ch-desc').textContent = desc;
  document.getElementById('chat-input').placeholder = `Message ${name}â€¦`;
  document.querySelectorAll('.channel-btn[data-ch]').forEach(b=>b.classList.toggle('active',b.dataset.ch===ch));
  showMembers = false;
  document.getElementById('chat-view').style.display = 'flex';
  document.getElementById('members-view').style.display = 'none';
  document.getElementById('view-members-btn').classList.remove('active');
  subscribeMessages();
}

function toggleMembersView() {
  showMembers = !showMembers;
  document.getElementById('chat-view').style.display = showMembers?'none':'flex';
  document.getElementById('members-view').style.display = showMembers?'flex':'none';
  document.getElementById('view-members-btn').classList.toggle('active',showMembers);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   INIT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
renderChips();
</script>

</body>
</html>
